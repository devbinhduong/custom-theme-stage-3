{"version":3,"file":"theme-bundle.chunk.444.js","mappings":"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","sources":["webpack://bigcommerce-hera/./assets/js/theme/gift-certificate.js"],"sourcesContent":["import PageManager from './page-manager';\nimport nod from './common/nod';\nimport checkIsGiftCertValid from './common/gift-certificate-validator';\nimport formModel from './common/models/forms';\nimport { createTranslationDictionary } from './common/utils/translations-utils';\nimport { announceInputErrorMessage } from './common/utils/form-utils';\nimport { api } from '@bigcommerce/stencil-utils';\nimport { defaultModal } from './global/modal';\n\nexport default class GiftCertificate extends PageManager {\n    constructor(context) {\n        super(context);\n        this.validationDictionary = createTranslationDictionary(context);\n\n        const $certBalanceForm = $('#gift-certificate-balance');\n\n        const purchaseModel = {\n            recipientName(val) {\n                return val.length;\n            },\n            recipientEmail(...args) {\n                return formModel.email(...args);\n            },\n            senderName(val) {\n                return val.length;\n            },\n            senderEmail(...args) {\n                return formModel.email(...args);\n            },\n            customAmount(value, min, max) {\n                return value && value >= min && value <= max;\n            },\n            setAmount(value, options) {\n                let found = false;\n\n                options.forEach((option) => {\n                    if (option === value) {\n                        found = true;\n                        return false;\n                    }\n                });\n\n                return found;\n            },\n        };\n\n        const $purchaseForm = $('#gift-certificate-form');\n        const $customAmounts = $purchaseForm.find('input[name=\"certificate_amount\"]');\n        const purchaseValidator = nod({\n            submit: '#gift-certificate-form input[type=\"submit\"]',\n            delay: 300,\n            tap: announceInputErrorMessage,\n        });\n\n        if ($customAmounts.length) {\n            const $element = $purchaseForm.find('input[name=\"certificate_amount\"]');\n            const min = $element.data('min');\n            const minFormatted = $element.data('minFormatted');\n            const max = $element.data('max');\n            const maxFormatted = $element.data('maxFormatted');\n            const insertFormattedAmountsIntoErrorMessage = (message, ...amountRange) => {\n                const amountPlaceholders = ['[MIN]', '[MAX]'];\n                let updatedErrorText = message;\n                amountPlaceholders.forEach((placeholder, i) => {\n                    updatedErrorText = updatedErrorText.includes(placeholder) ?\n                        updatedErrorText.replace(placeholder, amountRange[i]) :\n                        updatedErrorText;\n                });\n                return updatedErrorText;\n            };\n\n            purchaseValidator.add({\n                selector: '#gift-certificate-form input[name=\"certificate_amount\"]',\n                validate: (cb, val) => {\n                    const numberVal = Number(val);\n\n                    if (!numberVal) {\n                        cb(false);\n                    }\n\n                    cb(numberVal >= min && numberVal <= max);\n                },\n                errorMessage: insertFormattedAmountsIntoErrorMessage(this.validationDictionary.certificate_amount_range, minFormatted, maxFormatted),\n            });\n        }\n\n        purchaseValidator.add([\n            {\n                selector: '#gift-certificate-form input[name=\"to_name\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.recipientName(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.toName,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"to_email\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.recipientEmail(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.toEmail,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"to_email2\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.recipientEmail(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.toEmail2,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"from_name\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.senderName(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.fromName,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"from_email\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.senderEmail(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.fromEmail,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"from_email2\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.senderEmail(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.fromEmail2,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"certificate_theme\"]:first-of-type',\n                triggeredBy: '#gift-certificate-form input[name=\"certificate_theme\"]',\n                validate: (cb) => {\n                    const val = $purchaseForm.find('input[name=\"certificate_theme\"]:checked').val();\n\n                    cb(typeof (val) === 'string');\n                },\n                errorMessage: this.context.certTheme,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"agree\"]',\n                validate: (cb) => {\n                    const val = $purchaseForm.find('input[name=\"agree\"]').get(0).checked;\n\n                    cb(val);\n                },\n                errorMessage: this.context.agreeToTerms,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"agree2\"]',\n                validate: (cb) => {\n                    const val = $purchaseForm.find('input[name=\"agree2\"]').get(0).checked;\n\n                    cb(val);\n                },\n                errorMessage: this.context.agreeToTerms,\n            },\n        ]);\n\n        if ($certBalanceForm.length) {\n            const balanceVal = this.checkCertBalanceValidator($certBalanceForm);\n\n            $certBalanceForm.on('submit', () => {\n                balanceVal.performCheck();\n\n                if (!balanceVal.areAll('valid')) {\n                    return false;\n                }\n            });\n        }\n\n        $purchaseForm.on('submit', event => {\n            purchaseValidator.performCheck();\n\n            if (!purchaseValidator.areAll('valid')) {\n                return event.preventDefault();\n            }\n        });\n\n        $('#gift-certificate-preview').click(event => {\n            event.preventDefault();\n\n            // purchaseValidator.performCheck();\n\n            // if (!purchaseValidator.areAll('valid')) {\n            //     return;\n            // }\n\n            const modal = defaultModal();\n            const previewUrl = `${$(event.currentTarget).data('previewUrl')}&${$purchaseForm.serialize()}`;\n\n            let updateContent = document.querySelector('.updateCardContent');\n\n            \n            // modal.open();\n\n            api.getPage(previewUrl, {}, (err, content) => {\n                if (err) {\n                    // return modal.updateContent(this.context.previewError);\n                    updateContent.innerHTML = err;\n                }\n\n                // modal.updateContent(content, { wrap: true });\n\n                updateContent.innerHTML = content;\n            });\n        });\n    }\n\n    checkCertBalanceValidator($balanceForm) {\n        const balanceValidator = nod({\n            submit: $balanceForm.find('input[type=\"submit\"]'),\n            tap: announceInputErrorMessage,\n        });\n\n        balanceValidator.add({\n            selector: $balanceForm.find('input[name=\"giftcertificatecode\"]'),\n            validate(cb, val) {\n                cb(checkIsGiftCertValid(val));\n            },\n            errorMessage: this.validationDictionary.invalid_gift_certificate,\n        });\n\n        return balanceValidator;\n    }\n}\n"],"names":["GiftCertificate","_PageManager","context","_this","call","validationDictionary","createTranslationDictionary","$certBalanceForm","$","purchaseModel","formModel","email","apply","arguments","$purchaseForm","$customAmounts","find","purchaseValidator","nod","submit","delay","tap","announceInputErrorMessage","length","$element","min","data","minFormatted","max","maxFormatted","add","selector","validate","cb","val","numberVal","Number","errorMessage","message","_len","amountRange","Array","_key","updatedErrorText","forEach","placeholder","i","includes","replace","insertFormattedAmountsIntoErrorMessage","certificate_amount_range","toName","toEmail","toEmail2","fromName","fromEmail","fromEmail2","triggeredBy","certTheme","get","checked","agreeToTerms","balanceVal","checkCertBalanceValidator","on","performCheck","areAll","event","preventDefault","click","defaultModal","previewUrl","currentTarget","serialize","updateContent","document","querySelector","api","getPage","err","content","innerHTML","prototype","$balanceForm","balanceValidator","checkIsGiftCertValid","this","invalid_gift_certificate","PageManager"],"sourceRoot":""}